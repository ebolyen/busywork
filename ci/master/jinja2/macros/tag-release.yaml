{%- macro make_config(projects) %}
platform: linux

image_resource:
  type: docker-image
  source:
    repository: continuumio/miniconda3
    version: latest

params:
  - REPOS_STRING: "{{ projects|join(' ', attribute='name') }}"
  {%- raw %}
  - GITHUB_USER: {{github_user}}
  - GITHUB_PASS: {{github_pass}}
  {%- endraw %}

inputs:
  - name: busywork
  {%- for project in projects %}
  - name: {{ project.name }}-source
  {%- endfor %}

outputs:
  {%- for project in projects %}
  - name: tagged-{{ project.name }}-source
  {%- endfor %}

run:
  path: busywork/ci/master/bin/tag-release.sh
{%- endmacro %}
